<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hosting a Minecraft Server on AWS | Adam Aguilera</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/blogstyle.css">
    <script src="/components.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Handle tab switching
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', function () {
                    if (this.getAttribute('data-tab') === 'resume') {
                        window.location.href = '/';
                    }
                });
            });

            // Add a click handler to the back link
            document.querySelector('.back-link').addEventListener('click', function (e) {
                e.preventDefault();
                window.location.href = this.href;
            });
        });
    </script>
</head>

<body>
    <div class="left-side-container"></div>
    <div class="right-side">
        <div class="nav-container"></div>
        <div class="tab-content">
            <div class="blog-post">
                <div class="content">
                    <h1>Hosting a Minecraft Server on AWS</h1>
<p><em>September 15, 2024</em></p>
<p>It’s that time of year again. Your friends run out of things to do and someone throws out the idea to play Minecraft. If you are like me, you have the last five servers saved somewhere in your computer but they are from a year ago. Outdated version, new router to port-forward, new IP address to share. My friends don&#39;t miss the opportunity to remind me about the latency between New York and California.</p>
<p>Although Minecraft Realms and third party hosting services have gotten incredibly cheap, the lack of total control to add mods, use optimized servers like PaperMC, or even assigning a fixed server URL are serious pains. Having to agree to a monthly subscription that makes me responsible for killing the server breaks the camel&#39;s back.</p>
<p>I decided to find a way to set up a server with three priorities:</p>
<ul>
<li>No subscriptions</li>
<li>Available at all times</li>
<li>Performant</li>
</ul>
<p>This started my investigation into hosting a game server on AWS.</p>
<h2>EC2 with Usage-Based Billing</h2>
<p>The server runs on an AWS EC2 instance. The key to cost optimization lies in understanding how EC2 instances are billed. You are not charged for a stopped EC2 instance. We can configure the server to shut down when not in use, drastically reducing idle time costs. A simple CloudWatch alarm on the EC2 instance monitoring network activity suffices. If no network packets are detected for a defined period of time (e.g. 30 minutes), the alarm triggers an action to stop the EC2 instance. When the last person disconnects from the server, it&#39;ll automatically shut down.</p>
<h2>On-Demand Power-Up</h2>
<p>A stopped server is useless to my friends. We need to create a switch that can turn on the server. A simple Lambda function is capable of starting an EC2 instance and costs practically nothing. The problem is, my friends can’t do anything with this Lambda. A simple button on a website can remove the complexity of a CURL request, but I’m not so confident about exposing this endpoint to the public.</p>
<p>After some thought, I realized all of my friends are already in a private server on Discord. A <a href="https://support-apps.discord.com/hc/en-us/articles/26501837786775-Slash-Commands-FAQ">Discord slash command</a> is a great way to address both security and accessibility. A /start-minecraft command can be registered directly with Discord’s API. When a user types the command, Discord will send a secure request to Amazon API Gateway which triggers the Lambda function to start the server. </p>
<p>For a deeper dive into setting up a Discord bot with AWS Lambda and API Gateway for slash commands, this README is a great resource: <a href="https://github.com/ker0olos/aws-lambda-discord-bot">AWS Lambda Discord Bot</a>.</p>
<h3>The IPv4 Problem and the IPv6 Solution</h3>
<p>A crucial hurdle in hosting game servers is the IP address. When an EC2 instance is stopped and then restarted, it receives a new public IPv4 address. This makes it difficult to reliably save a server to your game client.</p>
<p>AWS offers Elastic IPs (EIPs) for IPv4, which are static public IP addresses that can be associated with an EC2 instance. This is a perfect solution except EIPs incur a static fee if they are not associated with a running EC2 instance. A great workaround is to rely on an IPv6 address which does not have the same fees due to its 340 undecillion total number of addresses.</p>
<p>To leverage this free workaround, both AWS network gateway and EC2 instance have to be configured to only support IPv6:</p>
<ul>
<li><strong>VPC with IPv6 CIDR:</strong> Virtual Private Cloud (VPC) needs to have an associated IPv6 CIDR block.</li>
<li><strong>Subnet with IPv6 CIDR:</strong> The subnet containing the EC2 instance also needs an IPv6 CIDR block.</li>
<li><strong>EC2 Instance IPv6 Address:</strong> When the EC2 instance is launched, assign it an IPv6 address from the subnet&#39;s range. This IPv6 address remains static for the instance, even when it&#39;s stopped and started.</li>
<li><strong>Internet Gateway for IPv6:</strong> Ensure VPC has an Internet Gateway configured to route IPv6 traffic.</li>
<li><strong>Security Group Rules:</strong> Configure the EC2 instance&#39;s security group to allow incoming traffic on the Minecraft server&#39;s port (default 25565) over IPv6.</li>
</ul>
<p><em>Note that this means friends using an IPv4-only router won’t be able to connect</em></p>
<p>A final polishing step is to associate the static IPv6 to a domain name to make it easier to share with friends. I created a subdomain one one I already owned on <a href="https://www.squarespace.com/">SquareSpace</a> to link with the AWS IPv6 address.</p>
<p>A year later, I&#39;ve only spent about $10 on AWS with no maintenance. It’s cheap, easy to use and ready for the next time my friends want to play.</p>

                </div>
                <div class="back-button-container">
                    <a href="/blog/" class="back-link">
                        <span class="back-arrow">←</span>
                        <span class="back-text">Back to Blog</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</body>

</html>